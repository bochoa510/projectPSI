improvements for rev 2:
